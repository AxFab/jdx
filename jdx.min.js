/* jDx.js | extension for JavaScript date. | MIT License | Copyright (C) 2016  Fabien Bavent */
"use strict";var jDx=function(){var e={},t={},r={};t.en={masks:{default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",sortableDate:"yyyy/mm/dd",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};var s=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloOSZ]|"[^"]*"|'[^']*'/g,a={d:{r:"[1-3]?[0-9]",t:"day"},dd:{r:"[0-3][0-9]",t:"day"},ddd:{r:"[A-Za-z]+"},dddd:{r:"[A-Za-z]+"},m:{r:"1?[0-9]",t:"month"},mm:{r:"[0-1][0-9]",t:"month"},mmm:{r:"[A-Za-z]+",t:"month"},mmmm:{r:"[A-Za-z]+",t:"month"},yy:{r:"[0-9]{2}",t:"year"},yyyy:{r:"[0-9]{4}",t:"year"},h:{r:"1?[0-9]",t:"hours"},hh:{r:"[0-1][0-9]",t:"hours"},H:{r:"[1-2]?[0-9]",t:"hours"},HH:{r:"[0-2][0-9]",t:"hours"},M:{r:"[1-5]?[0-9]",t:"mins"},MM:{r:"[0-5][0-9]",t:"mins"},s:{r:"[1-5]?[0-9]",t:"secs"},ss:{r:"[0-5][0-9]",t:"secs"},l:{r:"[0-9]{3}",t:"ms"},L:{r:"[0-9]{2}",t:"ms"},t:{r:"[ap]",t:"TT"},tt:{r:"[ap]m",t:"TT"},T:{r:"[AP]",t:"TT"},TT:{r:"[AP]M",t:"TT"},Z:{r:"UTC|GMT[+-][0-9]{4}",t:"gmt"},o:{r:"[+-][0-9]+",t:"gmt"},O:{r:"[+-][0-9]{2}:[0-9]{2}",t:"gmt"},S:{r:"th|st|nd|rd"}},n=function(e,t,s){var a=t?"getUTC":"get",n=e[a+"Date"](),o=e[a+"Day"](),m=e[a+"Month"](),d=e[a+"FullYear"](),y=e[a+"Hours"](),u=e[a+"Minutes"](),c=e[a+"Seconds"](),l=e[a+"Milliseconds"](),h=t?0:e.getTimezoneOffset();return{d:n,dd:i(n),ddd:r.dayNames[o],dddd:r.dayNames[o+7],m:m+1,mm:i(m+1),mmm:r.monthNames[m],mmmm:r.monthNames[m+12],yy:d.toString().slice(2),yyyy:d,h:y%12||12,hh:i(y%12||12),H:y,HH:i(y),M:u,MM:i(u),s:c,ss:i(c),l:i(l,3),L:i(l>99?Math.round(l/10):l),t:y<12?"a":"p",tt:y<12?"am":"pm",T:y<12?"A":"P",TT:y<12?"AM":"PM",Z:t?"UTC":s,o:(h>0?"-":"+")+i(100*Math.floor(Math.abs(h)/60)+Math.abs(h)%60,4),O:(h>0?"-":"+")+i(Math.floor(Math.abs(h)/60))+i(Math.floor(Math.abs(h)%60)),S:["th","st","nd","rd"][n%10>3?0:(n%100-n%10!==10)*n%10]}},o=function(e){var t={},r=0;if("UTC:"===e.slice(0,4)&&(e=e.slice(4),t.utc=!0),e=e.replace(/\\/g,"\\\\"),e=e.replace(/\//g,"\\/"),e=e.replace(/,/g,",?"),e=e.replace(s,function(e){return a[e]?(t[a[e].t]=++r,"("+a[e].r+")"):e.slice(1,e.length-1)}),e=e.replace(/\s+/g,"\\s+"),t.reg=new RegExp("^\\s*"+e+"\\s*$"),0===r)throw new SyntaxError("This is not a format for a date.");if(typeof t.month!=typeof t.year)throw new SyntaxError("A month need a year and vice-versa.");if(t.day&&typeof t.day!=typeof t.month)throw new SyntaxError("A day can't be set without month.");if(t.secs&&typeof t.secs!=typeof t.mins)throw new SyntaxError("Seconds without minutes doesn't make sense.");if(t.ms&&typeof t.ms!=typeof t.secs)throw new SyntaxError("Milliseconds without seconds doesn't make sense.");return t},m={setHours:function(e,t,r,s){if(t.hours){var a=0;t.TT&&"PM"===r[t.TT].toUpperCase()&&(a=12),s.utc||t.utc?a+=s.tzHour:t.gmt&&(a+=s.gmHour-s.tzHour),e.setHours(parseInt(r[t.hours])+a)}else e.setHours(0-(s.utc||t.utc?0:s.tzHour))},setMinutes:function(e,t,r,s){if(t.mins){var a=0;s.utc||t.utc?a+=s.tzMin:t.gmt&&(a+=s.gmMin-s.tzMin),e.setMinutes(parseInt(r[t.mins])+a)}else e.setMinutes(0-(s.utc||t.utc?0:s.tzMin));t.secs?e.setSeconds(parseInt(r[t.secs])):e.setSeconds(0)},setDate:function(e,t,s,a){if(t.month){var n=parseInt(s[t.month]);if(isNaN(n)){var o=r.monthNames;for(n=0;n<o.length&&s[t.month]!==o[n];++n);n=(n+1)%12}e.setMonth(n-1);var m=0;2===s[t.year].length&&(m=100*parseInt(a.year/100)),e.setYear(parseInt(s[t.year])+m)}if(t.day){var i=parseInt(s[t.day]);e.setDate(i)}}},i=function(e,t){for(e=e.toString(),t=t||2;e.length<t;)e="0"+e;return e};return e.formatDate=function(e,t,a){1===arguments.length&&"string"==typeof e&&(t=o,e=void 0),t=r.masks[t]||t||r.masks.default;var o=e?new Date(e):new Date;if(isNaN(o))throw SyntaxError("invalid date: '"+e+"'");"UTC:"===t.slice(0,4)&&(t=t.slice(4),a=!0);var m=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,d=(o.toString().match(m)||[""]).pop().replace(i,""),y=n(o,a,d);return t.replace(s,function(e){return y[e]?y[e]:e.slice(1,e.length-1)})},e.parseDate=function(e,t,s){var a,n=new Date,i=new Date,d=-n.getTimezoneOffset(),y=r.models[t]||t;if("string"==typeof y)y=o(t),r.models[t]=y,a=y.reg.exec(e);else if(y)a=y.reg.exec(e);else for(var u in r.models)if(y=r.models[u],a=y.reg.exec(e))break;if(!a)return NaN;var c={tzHour:d/60,tzMin:d%60,gmHour:0,gmMin:0,utc:s,year:n.getFullYear()};if(y.gmt){var l=a[y.gmt];"UTC"==l?(c.gmHour=0,c.gmMin=0):3==l.indexOf(":")?(c.gmHour=parseInt(l.substr(0,3)),c.gmMin=parseInt(l.substr(0,1)+l.substr(4))):(c.gmHour=parseInt(l.substr(3,3)),c.gmMin=parseInt(l.substr(3,1)+l.substr(6)))}return m.setHours(i,y,a,c),m.setMinutes(i,y,a,c),m.setDate(i,y,a,c),i},e.transform=function(t,r,s,a){return e.formatDate(e.parseDate(t,r,a),s,a)},e.relative=function(t,s){var a=[{presicion:1e3,max:60,word:"seconds"},{presicion:6e4,max:2,word:"minute"},{presicion:6e4,max:60,word:"minutes"},{presicion:36e5,max:2,word:"hour"},{presicion:36e5,max:24,word:"hours"},{presicion:864e5,max:2,word:"day"},{presicion:864e5,max:30,word:"days"},{presicion:2628002880,max:2,word:"month"},{presicion:2628002880,max:12,word:"months"},{presicion:131544e4,max:2,word:"year"},{presicion:131544e4,max:99999,word:"years"}];s?"string"==typeof s&&(s=e.parseDate(s)):s=new Date;var n=s.getTime()-t.getTime(),o=n<0?r.relative.future:r.relative.past,m=null,i=1,d=0;for(n=Math.abs(n);n<a[d].presicion*a[d].max;)++d;return m=r.relative[a[d].word],i=parseInt(n/a[d].presicion),m="function"==typeof m?m(i):m.replace("%d",i),o.replace("%s",m)},e.addLang=function(e,r){if(t[e]=r,!r.masks||!r.dayNames||r.dayNames.length<14||!r.monthNames||r.monthNames.length<24)throw new Error('Invalid locale data "'+e+'".');r.masks.isoDate="yyyy-mm-dd",r.masks.isoTime="HH:MM:ss",r.masks.isoDateTime="yyyy-mm-dd'T'HH:MM:ss",r.masks.isoUtcDateTime="UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},e.setLang=function(s,a){a&&e.addLang(s,a),r=t[s]||t.en,r.models={};for(var n in r.masks)r.models[n]=o(r.masks[n]);return t[s]?e:null},e.setLang("en")}();"undefined"!=typeof module&&module.exports&&(module.exports=jDx);